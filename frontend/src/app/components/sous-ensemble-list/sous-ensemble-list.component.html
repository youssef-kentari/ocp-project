<div class="sous-ensembles-container">
  <!-- Partie Recherche / Filtres -->
  <div class="filters-section w-50 p-3 mb-4 bg-white rounded shadow-sm">
    <h5 class="mb-3 text-primary-dark"><strong>Filtrage</strong></h5>

    <div class="input-group mb-3 gap-2">
      <input type="text" class="form-control rounded-pill border-primary" placeholder="Recherche par Désignation"
        [(ngModel)]="designation" (keyup.enter)="searchDesignation()" />
      <button class="btn btn-primary rounded-pill" type="button" (click)="searchDesignation()">
        <i class="fas fa-search me-1"></i>Rechercher
      </button>
    </div>

    <div class="input-group mb-3 gap-2">
      <input type="text" class="form-control rounded-pill border-primary" placeholder="Filtrer par Engin ID"
        [(ngModel)]="enginId" />
      <button class="btn btn-outline-primary rounded-pill" type="button" (click)="retrieveByEngin()">
        <i class="fas fa-filter me-1"></i>Filtrer
      </button>
      <button class="btn btn-outline-secondary rounded-pill" type="button" (click)="refreshList()">
        <i class="fas fa-sync-alt me-1"></i>Réinitialiser
      </button>
    </div>
  </div>

  <div class="d-flex justify-content-end">
    <button class="btn btn-info" (click)="navigateToAddPage()">
      <i class="fas fa-plus"></i> Ajouter
    </button>
  </div>

  <!-- Liste des Sous-Ensembles -->
  <div class="">
    <div class="list-section ">
      <div class="badge bg-primary-dark rounded-pill px-3 py-2 mb-3">
        <h5 class="mb-0 text-dark"><i class="fas fa-cubes me-2"></i><strong>Sous-Ensembles</strong></h5>
      </div>
      <ul class="list-group sous-ensemble-list shadow-sm" style="max-height: 400px; overflow-y: auto;">
        <li *ngFor="let se of sousEnsembles; let i = index"
          class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
          [class.active]="i === currentIndex" (click)="setActiveSousEnsemble(se, i)">
          <span>
            <span class="badge bg-primary-light text-primary-dark me-2">#{{se.sous_ensemble_id}}</span>
            {{ se.designation }}
          </span>
          <small class="text-muted">Engin: {{ se.engin_id }}</small>
        </li>
        <li *ngIf="sousEnsembles.length === 0" class="list-group-item text-muted text-center py-4">
          <i class="far fa-folder-open me-2"></i>Aucun sous-ensemble trouvé
        </li>
      </ul>
    </div>

    <!-- Détails du Sous-Ensemble Sélectionné -->
    <div class="details-section ">
      <app-sous-ensemble-details [viewMode]="showDetails" [currentSousEnsemble]="currentSousEnsemble"
        (refreshList)="refreshList()">
      </app-sous-ensemble-details>
    </div>
  </div>
</div>

<style>
  .sous-ensembles-container {
    padding: 1.5rem;
    background-color: var(--gray-very-light);
  }

  .filters-section {
    border: 1px solid var(--gray-light);
  }

  .list-group-item {
    transition: all 0.2s;
    border-left: none;
    border-right: none;
  }

  .list-group-item:hover:not(.active) {
    background-color: var(--primary-light);
  }

  .list-group-item.active {
    background-color: var(--primary-main);
    border-color: var(--primary-main);
    color: rgb(59, 103, 76);
  }

  .border-primary {
    border-color: var(--primary-main) !important;
  }

  .btn-primary {
    background-color: var(--primary-main);
    border-color: var(--primary-main);
  }

  .btn-outline-primary {
    color: var(--primary-main);
    border-color: var(--primary-main);
  }

  .btn-outline-primary:hover {
    background-color: var(--primary-main);
    color: white;
  }

  .text-primary-dark {
    color: var(--primary-dark);
  }

  .bg-primary-dark {
    background-color: var(--primary-dark) !important;
  }

  .bg-primary-light {
    background-color: var(--primary-light) !important;
  }
</style>